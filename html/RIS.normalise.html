<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>RIS.normalise: normal form for words up-to alpha-equivalence.</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">RIS.normalise: normal form for words up-to alpha-equivalence.</h1>

<div class="code">
</div>

<div class="doc">

</div>
<div class="code">
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="RIS.transducer.html#"><span class="id" title="library">transducer</span></a> <a class="idref" href="RIS.representative.html#"><span class="id" title="library">representative</span></a> <a class="idref" href="RIS.traces.html#"><span class="id" title="library">traces</span></a> <a class="idref" href="RIS.alternate_eq.html#"><span class="id" title="library">alternate_eq</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="s"><span class="id" title="section">s</span></a>.<br/>
</div>

<div class="doc">
<a name="lab99"></a><h1 class="section">Adding natural numbers in the set of atoms</h1>
 Let us fix a set of atoms and an alphabet. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">atom</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Set</span>}{𝐀 : <a class="idref" href="RIS.atoms.html#Atom"><span class="id" title="class">Atom</span></a> <a class="idref" href="RIS.normalise.html#atom"><span class="id" title="variable">atom</span></a>} {𝐗 : <a class="idref" href="RIS.words.html#Alphabet"><span class="id" title="class">Alphabet</span></a> <a class="idref" href="RIS.normalise.html#8641701fafbb6d109185a381b5830e92"><span class="id" title="variable">𝐀</span></a> <a class="idref" href="RIS.normalise.html#X"><span class="id" title="variable">X</span></a>}.<br/>

<br/>
</div>

<div class="doc">
<a name="lab100"></a><h2 class="section">Lifting variables</h2>
 We write <span class="inlinecode">𝐎</span> for the set of representatives of <span class="inlinecode"><span class="id" title="var">X</span></span>, as constructed in <span class="inlinecode"><span class="id" title="var">RIS.representative</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="741522e6686bdc319766d9a002321212"><span class="id" title="definition">𝐎</span></a> := (@<a class="idref" href="RIS.representative.html#Repr"><span class="id" title="definition">Repr</span></a> <span class="id" title="var">_</span> <a class="idref" href="RIS.normalise.html#s.X"><span class="id" title="variable">X</span></a> <a class="idref" href="RIS.normalise.html#1ed9c442daa4176d58e205d8f4f1e274"><span class="id" title="variable">𝐀</span></a>).<br/>

<br/>
</div>

<div class="doc">
For technical reasons, in the following we need the set of representatives to be a nominal <i>set</i> rather than a nominal <i>setoid</i>. This is due to our definition of an alphabet. Therefore, we assume we have a function <span class="inlinecode"><span class="id" title="var">ϕ</span></span> from <span class="inlinecode">𝐎</span> to some set <span class="inlinecode"><span class="id" title="var">R</span></span>, decidable and nominal over <span class="inlinecode"><span class="id" title="var">pointer</span></span>, such that: 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="R"><span class="id" title="axiom">R</span></a> : <span class="id" title="keyword">Set</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {𝐑 : <a class="idref" href="RIS.words.html#Alphabet"><span class="id" title="class">Alphabet</span></a> <a class="idref" href="RIS.representative.html#5754fb4bffa6f27d56a47102cb7ffc62"><span class="id" title="instance">𝐏</span></a> <a class="idref" href="RIS.normalise.html#R"><span class="id" title="axiom">R</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="6c4dbec1c9102e1076a6a6ca04576cf0"><span class="id" title="axiom">ϕ</span></a> : <a class="idref" href="RIS.normalise.html#741522e6686bdc319766d9a002321212"><span class="id" title="definition">𝐎</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#R"><span class="id" title="axiom">R</span></a>.<br/>
</div>

<div class="doc">
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">ϕ</span></span> is injective up-to <span class="inlinecode">≃</span>; 
</li>
</ul>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="3a021bbb67d84b428a7e6d8042b20849"><span class="id" title="axiom">ϕ_inj</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <a class="idref" href="RIS.normalise.html#741522e6686bdc319766d9a002321212"><span class="id" title="definition">𝐎</span></a>, <a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="RIS.tools.html#63510515077225ba3be50ed1e1ec3cec"><span class="id" title="notation">≃</span></a> <a class="idref" href="RIS.normalise.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="RIS.normalise.html#6c4dbec1c9102e1076a6a6ca04576cf0"><span class="id" title="axiom">ϕ</span></a> <a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#6c4dbec1c9102e1076a6a6ca04576cf0"><span class="id" title="axiom">ϕ</span></a> <a class="idref" href="RIS.normalise.html#y"><span class="id" title="variable">y</span></a>.<br/>
</div>

<div class="doc">
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">ϕ</span></span> is equivariant; 
</li>
</ul>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="83de907f5b194ec9bbe2e48d4bc115bf"><span class="id" title="axiom">ϕ_equivariant</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span>, <a class="idref" href="RIS.normalise.html#6c4dbec1c9102e1076a6a6ca04576cf0"><span class="id" title="axiom">ϕ</span></a> (<a class="idref" href="RIS.normalise.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="RIS.nominalsetoid.html#07511cc7b4449ee9480d9ba5e0461640"><span class="id" title="notation">⊙</span></a><a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙(</span></a><a class="idref" href="RIS.normalise.html#6c4dbec1c9102e1076a6a6ca04576cf0"><span class="id" title="axiom">ϕ</span></a> <a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">)</span></a>.<br/>
</div>

<div class="doc">
<ul class="doclist">
<li> and <span class="inlinecode"><span class="id" title="var">ϕ</span></span> preserves supports. 
</li>
</ul>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="4c8332d96bef456f5901d04445156cfe"><span class="id" title="axiom">ϕ_support</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><a class="idref" href="RIS.normalise.html#6c4dbec1c9102e1076a6a6ca04576cf0"><span class="id" title="axiom">ϕ</span></a> <a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a> <a class="idref" href="RIS.tools.html#8a93d10600b37e2dc6f02b51aaad94b8"><span class="id" title="notation">≈</span></a> <a class="idref" href="RIS.nominalsetoid.html#f1d0c93cf3a4c2546abcd77134ca0628"><span class="id" title="notation">⌈</span></a><a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="RIS.nominalsetoid.html#f1d0c93cf3a4c2546abcd77134ca0628"><span class="id" title="notation">⌉</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab101"></a><h2 class="section">Lifting letters</h2>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a name="8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">&quot;</span></a> a ? " := (@<a class="idref" href="RIS.representative.html#bound"><span class="id" title="constructor">bound</span></a> <a class="idref" href="RIS.normalise.html#s.atom"><span class="id" title="variable">atom</span></a> <span class="id" title="var">a</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20).<br/>

<br/>
</div>

<div class="doc">
We can build using <span class="inlinecode"><span class="id" title="var">η</span>,</span> <span class="inlinecode"><span class="id" title="var">ϕ</span></span> and <span class="inlinecode">!</span> a map <span class="inlinecode">⦑</span> <span class="inlinecode">⦒:</span> <span class="inlinecode"><span class="id" title="var">letter</span></span> <span class="inlinecode">𝐀</span> <span class="inlinecode">𝐗</span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">letter</span></span> <span class="inlinecode">𝐏</span> <span class="inlinecode">𝐑</span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="repr_letter"><span class="id" title="definition">repr_letter</span></a> : @<a class="idref" href="RIS.words.html#letter"><span class="id" title="inductive">letter</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="RIS.normalise.html#1ed9c442daa4176d58e205d8f4f1e274"><span class="id" title="variable">𝐀</span></a> <a class="idref" href="RIS.normalise.html#890c9d41045c0ae8f64b778f78e61027"><span class="id" title="variable">𝐗</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> @<a class="idref" href="RIS.words.html#letter"><span class="id" title="inductive">letter</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="RIS.representative.html#5754fb4bffa6f27d56a47102cb7ffc62"><span class="id" title="instance">𝐏</span></a> <a class="idref" href="RIS.normalise.html#cf3d8280a8ff28a7f0bab74f475b6f3b"><span class="id" title="variable">𝐑</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="RIS.normalise.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="RIS.words.html#e31864a9bb2098e815366ad06335894f"><span class="id" title="notation">⟨</span></a> <span class="id" title="var">a</span> ⇒ <a class="idref" href="RIS.words.html#e31864a9bb2098e815366ad06335894f"><span class="id" title="notation">⟨</span></a> <a class="idref" href="RIS.words.html#e31864a9bb2098e815366ad06335894f"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a><a class="idref" href="RIS.words.html#e31864a9bb2098e815366ad06335894f"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span> <a class="idref" href="RIS.words.html#66abf15cf8365c8375c75e08df16c6e2"><span class="id" title="notation">⟩</span></a> ⇒ <a class="idref" href="RIS.words.html#66abf15cf8365c8375c75e08df16c6e2"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a><a class="idref" href="RIS.words.html#66abf15cf8365c8375c75e08df16c6e2"><span class="id" title="notation">)</span></a> <a class="idref" href="RIS.words.html#66abf15cf8365c8375c75e08df16c6e2"><span class="id" title="notation">⟩</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="RIS.words.html#var"><span class="id" title="constructor">var</span></a> <span class="id" title="var">x</span> ⇒ <a class="idref" href="RIS.words.html#var"><span class="id" title="constructor">var</span></a> (<a class="idref" href="RIS.normalise.html#6c4dbec1c9102e1076a6a6ca04576cf0"><span class="id" title="axiom">ϕ</span></a>(<a class="idref" href="RIS.representative.html#6f2f7304141c15bf565f34aa10b8e335"><span class="id" title="definition">η</span></a> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a name="5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">&quot;</span></a> ⦑ l ⦒ " := (<a class="idref" href="RIS.normalise.html#repr_letter"><span class="id" title="definition">repr_letter</span></a> <span class="id" title="var">l</span>).<br/>

<br/>
</div>

<div class="doc">
The resulting function is injective and equivariant. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="repr_letter_injective"><span class="id" title="lemma">repr_letter_injective</span></a> : <a class="idref" href="RIS.tools.html#injective"><span class="id" title="class">injective</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> ⇒ <a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦑</span></a><a class="idref" href="RIS.normalise.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦒</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="repr_letter_equivariant"><span class="id" title="lemma">repr_letter_equivariant</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">x</span> : @<a class="idref" href="RIS.words.html#letter"><span class="id" title="inductive">letter</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="RIS.normalise.html#1ed9c442daa4176d58e205d8f4f1e274"><span class="id" title="variable">𝐀</span></a> <a class="idref" href="RIS.normalise.html#890c9d41045c0ae8f64b778f78e61027"><span class="id" title="variable">𝐗</span></a>) (π : @<a class="idref" href="RIS.atoms.html#perm"><span class="id" title="definition">perm</span></a> <span class="id" title="var">_</span> <a class="idref" href="RIS.normalise.html#1ed9c442daa4176d58e205d8f4f1e274"><span class="id" title="variable">𝐀</span></a>), <a class="idref" href="RIS.representative.html#56d09e85d5bc14580fb437962aa52c90"><span class="id" title="notation">⦅</span></a><a class="idref" href="RIS.normalise.html#31bf0b12546409e15021243132fc7574"><span class="id" title="variable">π</span></a><a class="idref" href="RIS.representative.html#56d09e85d5bc14580fb437962aa52c90"><span class="id" title="notation">⦆</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a> <a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦑</span></a> <a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦒</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦑</span></a> <a class="idref" href="RIS.normalise.html#31bf0b12546409e15021243132fc7574"><span class="id" title="variable">π</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a><a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦒</span></a>.<br/>

<br/>
</div>

<div class="doc">
Furthermore, the support of <span class="inlinecode">⦑<span class="id" title="var">x</span>⦒</span> is the set of free names <span class="inlinecode"><span class="id" title="var">a</span>!</span> such that <span class="inlinecode"><span class="id" title="var">a</span></span> is in the support of <span class="inlinecode"><span class="id" title="var">x</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="repr_letter_support"><span class="id" title="lemma">repr_letter_support</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦑</span></a><a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦒</span></a><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a> <a class="idref" href="RIS.tools.html#8a93d10600b37e2dc6f02b51aaad94b8"><span class="id" title="notation">≈</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="RIS.representative.html#free"><span class="id" title="constructor">free</span></a> <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">⦑<span class="id" title="var">_</span>⦒</span> preserves binding powers. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="repr_letter_binding"><span class="id" title="lemma">repr_letter_binding</span></a> <span class="id" title="var">a</span> <span class="id" title="var">l</span> : <a class="idref" href="RIS.words.html#b85990d49153579719311534d6a234cd"><span class="id" title="definition">𝗳</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="RIS.normalise.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.words.html#b85990d49153579719311534d6a234cd"><span class="id" title="definition">𝗳</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦑</span></a><a class="idref" href="RIS.normalise.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦒</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab102"></a><h2 class="section">Lifting words</h2>
 We write <span class="inlinecode"><span class="id" title="var">W</span></span> for words built out of <span class="inlinecode">⟨<span class="id" title="var">p</span></span>, <span class="inlinecode"><span class="id" title="var">p</span>⟩</span> and <span class="inlinecode"><span class="id" title="var">var</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span>, were <span class="inlinecode"><span class="id" title="var">p</span></span> ranges over pointers and <span class="inlinecode"><span class="id" title="var">r</span></span> ranges over <span class="inlinecode"><span class="id" title="var">R</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a name="W"><span class="id" title="abbreviation">W</span></a> := (@<a class="idref" href="RIS.words.html#word"><span class="id" title="definition">word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="RIS.normalise.html#cf3d8280a8ff28a7f0bab74f475b6f3b"><span class="id" title="variable">𝐑</span></a>).<br/>
</div>

<div class="doc">
We may naturally lift <span class="inlinecode">⦑</span> <span class="inlinecode">⦒:</span> <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">R</span></span> as <span class="inlinecode">⟪</span> <span class="inlinecode">⟫</span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">word</span></span> <span class="inlinecode">𝐀</span> <span class="inlinecode">𝐗</span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">W</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a name="2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">&quot;</span></a> ⟪ w ⟫ " := (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="RIS.normalise.html#repr_letter"><span class="id" title="definition">repr_letter</span></a> <span class="id" title="var">w</span>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">⟪<span class="id" title="var">_</span>⟫</span> is injective and equivariant. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="repr_word_injective"><span class="id" title="lemma">repr_word_injective</span></a> : <a class="idref" href="RIS.tools.html#injective"><span class="id" title="class">injective</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">u</span> ⇒ <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a>).<br/>
 
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="repr_word_perm"><span class="id" title="lemma">repr_word_perm</span></a> π <span class="id" title="var">u</span> : <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#31bf0b12546409e15021243132fc7574"><span class="id" title="variable">π</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.representative.html#56d09e85d5bc14580fb437962aa52c90"><span class="id" title="notation">⦅</span></a><a class="idref" href="RIS.normalise.html#31bf0b12546409e15021243132fc7574"><span class="id" title="variable">π</span></a><a class="idref" href="RIS.representative.html#56d09e85d5bc14580fb437962aa52c90"><span class="id" title="notation">⦆</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a> <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">⟪<span class="id" title="var">_</span>⟫</span> behaves well with supports. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="repr_word_support"><span class="id" title="lemma">repr_word_support</span></a> <span class="id" title="var">a</span> <span class="id" title="var">u</span> : <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a> <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">⟪<span class="id" title="var">_</span>⟫</span> preserves binding powers. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Corollary</span> <a name="repr_word_binding"><span class="id" title="lemma">repr_word_binding</span></a> <span class="id" title="var">a</span> <span class="id" title="var">u</span> : <a class="idref" href="RIS.words.html#c766319c772ae26267ccf42e128dd861"><span class="id" title="definition">𝗙</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.words.html#c766319c772ae26267ccf42e128dd861"><span class="id" title="definition">𝗙</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">⟪<span class="id" title="var">_</span>⟫</span> is injective up-to alpha-equivalence. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="repr_word_equiv"><span class="id" title="lemma">repr_word_equiv</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> : <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.tools.html#130feec68326dec2794bb89648a52e90"><span class="id" title="notation">≡</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a> <a class="idref" href="RIS.tools.html#130feec68326dec2794bb89648a52e90"><span class="id" title="notation">≡</span></a> <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab103"></a><h1 class="section">Valid words  and dynamic sequences</h1>
<a name="lab104"></a><h2 class="section">Validity</h2>
<a name="lab105"></a><h3 class="section">Definition</h3>
 A word <span class="inlinecode"><span class="id" title="var">u</span></span> is valid with respect to opening brackets if for every way of splitting <span class="inlinecode"><span class="id" title="var">u</span></span> into <span class="inlinecode"><span class="id" title="var">u1</span>++⟨<span class="id" title="var">n</span>?::<span class="id" title="var">u2</span></span>, <span class="inlinecode"><span class="id" title="var">n</span></span> is exactly the length of <span class="inlinecode"><span class="id" title="var">u1</span></span> and there is a match bracket <span class="inlinecode">?<span class="id" title="var">n</span>⟩</span> in <span class="inlinecode"><span class="id" title="var">u2</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="valid_open"><span class="id" title="definition">valid_open</span></a> (<span class="id" title="var">u</span> : <a class="idref" href="RIS.normalise.html#W"><span class="id" title="abbreviation">W</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">u1</span> <span class="id" title="var">u2</span> <span class="id" title="var">n</span>, <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a>(<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">u</span></span> is valid with respect to variable if for any decomposition <span class="inlinecode"><span class="id" title="var">u</span>=<span class="id" title="var">u1</span>++<span class="id" title="var">var</span></span> <span class="inlinecode"><span class="id" title="var">r</span>::<span class="id" title="var">u2</span></span>, and any bound number <span class="inlinecode"><span class="id" title="var">n</span>?∈⌊<span class="id" title="var">r</span>⌋</span>, there are match brackets <span class="inlinecode">⟨<span class="id" title="var">n</span>?</span> in <span class="inlinecode"><span class="id" title="var">u1</span></span> and <span class="inlinecode">?<span class="id" title="var">n</span>⟩</span> in <span class="inlinecode"><span class="id" title="var">u2</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="valid_var"><span class="id" title="definition">valid_var</span></a> (<span class="id" title="var">u</span> : <a class="idref" href="RIS.normalise.html#W"><span class="id" title="abbreviation">W</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">u1</span> <span class="id" title="var">u2</span> <span class="id" title="var">r</span> <span class="id" title="var">n</span>, <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#var"><span class="id" title="constructor">var</span></a> <a class="idref" href="RIS.normalise.html#r"><span class="id" title="variable">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a> <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><a class="idref" href="RIS.words.html#var"><span class="id" title="constructor">var</span></a> <a class="idref" href="RIS.normalise.html#r"><span class="id" title="variable">r</span></a><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a>.<br/>

<br/>
</div>

<div class="doc">
Finally, <span class="inlinecode"><span class="id" title="var">u</span></span> is valid with respect to closing brackets if for every decomposition <span class="inlinecode"><span class="id" title="var">u</span>=<span class="id" title="var">u1</span>++?<span class="id" title="var">n</span>⟩::<span class="id" title="var">u2</span></span> there is a matching bracket <span class="inlinecode">⟨?<span class="id" title="var">n</span></span> in <span class="inlinecode"><span class="id" title="var">u1</span></span> and no other <span class="inlinecode"><span class="id" title="var">n</span>?⟩</span> anywhere in <span class="inlinecode"><span class="id" title="var">u1</span>++<span class="id" title="var">u2</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="valid_close"><span class="id" title="definition">valid_close</span></a> (<span class="id" title="var">u</span> : <a class="idref" href="RIS.normalise.html#W"><span class="id" title="abbreviation">W</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">u1</span> <span class="id" title="var">u2</span> <span class="id" title="var">n</span>, <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a><a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">)</span></a>.<br/>

<br/>
</div>

<div class="doc">
A word is valid if it is valid with respect to all three kinds of letters. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="valid"><span class="id" title="definition">valid</span></a> <span class="id" title="var">u</span> := <a class="idref" href="RIS.normalise.html#valid_open"><span class="id" title="definition">valid_open</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.normalise.html#valid_var"><span class="id" title="definition">valid_var</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.normalise.html#valid_close"><span class="id" title="definition">valid_close</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="is_valid_open"><span class="id" title="lemma">is_valid_open</span></a> <span class="id" title="var">u1</span> <span class="id" title="var">u2</span> <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> (<a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a>(<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a>.<br/>
 
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="is_valid_var"><span class="id" title="lemma">is_valid_var</span></a> <span class="id" title="var">u1</span> <span class="id" title="var">u2</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> (<a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#var"><span class="id" title="constructor">var</span></a> <a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a> <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a>.<br/>
 
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="is_valid_close"><span class="id" title="lemma">is_valid_close</span></a> <span class="id" title="var">u1</span> <span class="id" title="var">u2</span> <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a>(<a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a><a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">)</span></a>.<br/>
 
<br/>
</div>

<div class="doc">
<a name="lab106"></a><h3 class="section">Boolean predicate</h3>
 <span class="inlinecode"><span class="id" title="var">test_var</span></span> <span class="inlinecode"><span class="id" title="var">w1</span></span> <span class="inlinecode"><span class="id" title="var">w2</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> is true if <span class="inlinecode"><span class="id" title="var">p</span></span> is a free name <span class="inlinecode"><span class="id" title="var">a</span>!</span> or a bound number <span class="inlinecode"><span class="id" title="var">k</span>?</span> such that <span class="inlinecode">⟨<span class="id" title="var">k</span>?</span> appears in <span class="inlinecode"><span class="id" title="var">w1</span></span> and <span class="inlinecode"><span class="id" title="var">k</span>?⟩</span> appears in <span class="inlinecode"><span class="id" title="var">w2</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="test_var"><span class="id" title="definition">test_var</span></a> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> (<span class="id" title="var">p</span> : @<a class="idref" href="RIS.representative.html#pointer"><span class="id" title="inductive">pointer</span></a> <a class="idref" href="RIS.normalise.html#s.atom"><span class="id" title="variable">atom</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="RIS.normalise.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="RIS.representative.html#bound"><span class="id" title="constructor">bound</span></a> <span class="id" title="var">k</span> ⇒ <a class="idref" href="RIS.tools.html#inb"><span class="id" title="definition">inb</span></a> (<a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<span class="id" title="var">k</span><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)) <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="RIS.tools.html#inb"><span class="id" title="definition">inb</span></a> (<a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a>(<span class="id" title="var">k</span><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)) <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">test_valid_aux</span></span> <span class="inlinecode"><span class="id" title="var">w1</span></span> <span class="inlinecode"><span class="id" title="var">w2</span></span> is the auxiliary function that we use to test validity of a string. Intuitively, when testing a word <span class="inlinecode"><span class="id" title="var">u</span></span>, we will successively test its suffixes <span class="inlinecode"><span class="id" title="var">w2</span></span>, while remembering the matching prefix <span class="inlinecode"><span class="id" title="var">rev</span></span> <span class="inlinecode"><span class="id" title="var">w1</span></span> to check for instance the presence of an opening bracket to the left of some closing bracket. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="test_valid_aux"><span class="id" title="definition">test_valid_aux</span></a> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.representative.html#bound"><span class="id" title="constructor">bound</span></a> <span class="id" title="var">k</span>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">w2</span> ⇒ <span class="id" title="var">k</span> <a class="idref" href="RIS.tools.html#f62e571aaf06e485801e62a5c9bd7232"><span class="id" title="notation">=?=</span></a> <a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="RIS.tools.html#inb"><span class="id" title="definition">inb</span></a> (<a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<span class="id" title="var">k</span><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)) <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="RIS.normalise.html#test_valid_aux"><span class="id" title="definition">test_valid_aux</span></a> (<a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<span class="id" title="var">k</span><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a>) <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.representative.html#bound"><span class="id" title="constructor">bound</span></a> <span class="id" title="var">k</span>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">w2</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.tools.html#inb"><span class="id" title="definition">inb</span></a> (<a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<span class="id" title="var">k</span><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)) <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="RIS.tools.html#inb"><span class="id" title="definition">inb</span></a> (<a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<span class="id" title="var">k</span><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)) (<a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="RIS.normalise.html#test_valid_aux"><span class="id" title="definition">test_valid_aux</span></a> (<a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a>(<span class="id" title="var">k</span><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a>) <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="RIS.words.html#var"><span class="id" title="constructor">var</span></a> <span class="id" title="var">r</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">w2</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#forallb"><span class="id" title="definition">forallb</span></a> (<a class="idref" href="RIS.normalise.html#test_var"><span class="id" title="definition">test_var</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a> <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a>) <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><span class="id" title="var">r</span><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="RIS.normalise.html#test_valid_aux"><span class="id" title="definition">test_valid_aux</span></a> (<a class="idref" href="RIS.words.html#var"><span class="id" title="constructor">var</span></a> <span class="id" title="var">r</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a>) <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">w2</span> ⇒ <a class="idref" href="RIS.normalise.html#test_valid_aux"><span class="id" title="definition">test_valid_aux</span></a> (<span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a>) <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="test_valid"><span class="id" title="definition">test_valid</span></a> <span class="id" title="var">w</span> := <a class="idref" href="RIS.normalise.html#test_valid_aux"><span class="id" title="definition">test_valid_aux</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>.<br/>

<br/>
</div>

<div class="doc">
We now prove that <span class="inlinecode"><span class="id" title="var">test_valid</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> correctly tests if <span class="inlinecode"><span class="id" title="var">w</span></span> is valid. Before doing so, we establish the following two facts.  If <span class="inlinecode"><span class="id" title="var">test_valid_aux</span></span> <span class="inlinecode">(<span class="id" title="var">rev</span></span> <span class="inlinecode"><span class="id" title="var">u1</span>++<span class="id" title="var">w</span>)</span> <span class="inlinecode"><span class="id" title="var">u2</span></span> is <span class="inlinecode"><span class="id" title="var">false</span></span>, then this value is propagated and therefore <span class="inlinecode"><span class="id" title="var">test_valid_aux</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode">(<span class="id" title="var">u1</span>++<span class="id" title="var">u2</span>)</span> is also <span class="inlinecode"><span class="id" title="var">false</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fact</span> <a name="test_valid_aux_false_app"><span class="id" title="lemma">test_valid_aux_false_app</span></a> <span class="id" title="var">w</span> <span class="id" title="var">u1</span> <span class="id" title="var">u2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#test_valid_aux"><span class="id" title="definition">test_valid_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#test_valid_aux"><span class="id" title="definition">test_valid_aux</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> (<a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">test_valid</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> is <span class="inlinecode"><span class="id" title="var">true</span></span> if and only if every test of suffixes of <span class="inlinecode"><span class="id" title="var">w</span></span> is <span class="inlinecode"><span class="id" title="var">true</span></span>, i.e. : 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fact</span> <a name="test_valid_true"><span class="id" title="lemma">test_valid_true</span></a> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#test_valid"><span class="id" title="definition">test_valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <span class="id" title="keyword">∀</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>, <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#test_valid_aux"><span class="id" title="definition">test_valid_aux</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>

<br/>
</div>

<div class="doc">
We may now check that a word is valid if and only if <span class="inlinecode"><span class="id" title="var">test_valid</span></span> of that word is <span class="inlinecode"><span class="id" title="var">true</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="test_valid_spec"><span class="id" title="lemma">test_valid_spec</span></a> <span class="id" title="var">w</span> : <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="RIS.normalise.html#test_valid"><span class="id" title="definition">test_valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab107"></a><h3 class="section">Remarks about validity</h3>
 <span class="inlinecode">⟪<span class="id" title="var">_</span>⟫</span> always produces valid words. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Proposition</span> <a name="valid_repr_word"><span class="id" title="lemma">valid_repr_word</span></a> <span class="id" title="var">u</span> : <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a>.<br/>

<br/>
</div>

<div class="doc">
If a bound number appears in the support of a valid word <span class="inlinecode"><span class="id" title="var">w</span></span>, then an opening bracket labelled with that number must be present in <span class="inlinecode"><span class="id" title="var">w</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="valid_support_open"><span class="id" title="lemma">valid_support_open</span></a> <span class="id" title="var">w</span> <span class="id" title="var">n</span> : <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">)</span></a> <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>.<br/>

<br/>
</div>

<div class="doc">
We may strengthen this remark, by noticing that <span class="inlinecode"><span class="id" title="var">n</span>?</span> belongs to the support of a valid word <span class="inlinecode"><span class="id" title="var">w</span></span> if and only if <span class="inlinecode"><span class="id" title="var">w</span></span>'s <span class="inlinecode"><span class="id" title="var">n</span></span>th letter is <span class="inlinecode">⟨<span class="id" title="var">n</span>?</span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="valid_support_open_explicit"><span class="id" title="lemma">valid_support_open_explicit</span></a> <span class="id" title="var">w</span> <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">)</span></a> <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a>.<br/>

<br/>
</div>

<div class="doc">
The support of a valid word may only contain bound numbers smaller than its length. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="valid_bound_support_lt"><span class="id" title="lemma">valid_bound_support_lt</span></a> <span class="id" title="var">u</span> <span class="id" title="var">n</span> : <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a> <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌊</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.atoms.html#2c0a5a7a3edbd2d036ce52734d0e9f72"><span class="id" title="notation">⌋</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a>.<br/>

<br/>
</div>

<div class="doc">
Numbers are always α-fresh in valid words. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="d49594a41a300770094edbdfe532b78d"><span class="id" title="lemma">valid_bound_αfresh</span></a> <span class="id" title="var">u</span> <span class="id" title="var">n</span> : <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a> <a class="idref" href="RIS.words.html#7ba554ef5fdf48b711c7d5458628b0bc"><span class="id" title="notation">#</span></a><a class="idref" href="RIS.words.html#7ba554ef5fdf48b711c7d5458628b0bc"><span class="id" title="notation">α</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a>.<br/>

<br/>
</div>

<div class="doc">
Validity may be characterised by the following property : <span class="inlinecode"><span class="id" title="var">u</span></span> is valid if and only if it has no α-free numbers and opening brackets labelled with a number only appear at the correct position. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Proposition</span> <a name="alternate_validity"><span class="id" title="lemma">alternate_validity</span></a> <span class="id" title="var">u</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a> <a class="idref" href="RIS.words.html#7ba554ef5fdf48b711c7d5458628b0bc"><span class="id" title="notation">#</span></a><a class="idref" href="RIS.words.html#7ba554ef5fdf48b711c7d5458628b0bc"><span class="id" title="notation">α</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">u1</span> <span class="id" title="var">u2</span> <span class="id" title="var">n</span>, <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#u2"><span class="id" title="variable">u2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#u1"><span class="id" title="variable">u1</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">)</span></a>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab108"></a><h2 class="section">Defects</h2>
 <span class="inlinecode"><span class="id" title="var">w</span></span> has a defect if it can be decomposed as <span class="inlinecode"><span class="id" title="var">w1</span>++⟨<span class="id" title="var">a</span>!::<span class="id" title="var">w2</span>++<span class="id" title="var">a</span>!⟩++<span class="id" title="var">w3</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="match_defect"><span class="id" title="definition">match_defect</span></a> <span class="id" title="var">w</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> <span class="id" title="var">w3</span> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="RIS.words.html#e31864a9bb2098e815366ad06335894f"><span class="id" title="notation">⟨(</span></a><a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a><a class="idref" href="RIS.words.html#e31864a9bb2098e815366ad06335894f"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#66abf15cf8365c8375c75e08df16c6e2"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a><a class="idref" href="RIS.words.html#66abf15cf8365c8375c75e08df16c6e2"><span class="id" title="notation">)⟩</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w3"><span class="id" title="variable">w3</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">match_defectb</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> checks if <span class="inlinecode"><span class="id" title="var">w</span></span> has a decomposition <span class="inlinecode"><span class="id" title="var">w1</span>++<span class="id" title="var">a</span>!⟩::<span class="id" title="var">w2</span></span> such that <span class="inlinecode"><span class="id" title="var">w1</span></span> does not contain the letter <span class="inlinecode">⟨<span class="id" title="var">a</span>!</span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="match_defectb"><span class="id" title="definition">match_defectb</span></a> <span class="id" title="var">a</span> <span class="id" title="var">w</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">w</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#14a7a9c7dc61f86bfb664d400fabaf8a"><span class="id" title="notation">(</span></a><span class="id" title="var">l</span><a class="idref" href="RIS.tools.html#f62e571aaf06e485801e62a5c9bd7232"><span class="id" title="notation">=?=</span></a><a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a>(<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#14a7a9c7dc61f86bfb664d400fabaf8a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#14a7a9c7dc61f86bfb664d400fabaf8a"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#14a7a9c7dc61f86bfb664d400fabaf8a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<span class="id" title="var">l</span><a class="idref" href="RIS.tools.html#f62e571aaf06e485801e62a5c9bd7232"><span class="id" title="notation">=?=</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>))<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="RIS.normalise.html#match_defectb"><span class="id" title="definition">match_defectb</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#14a7a9c7dc61f86bfb664d400fabaf8a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="match_defectb_spec"><span class="id" title="lemma">match_defectb_spec</span></a> <span class="id" title="var">a</span> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#match_defectb"><span class="id" title="definition">match_defectb</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a>.<br/>

<br/>
</div>

<div class="doc">
With the predicate <span class="inlinecode"><span class="id" title="var">match_defectb</span></span>, we can reformulate <span class="inlinecode"><span class="id" title="var">match_defect</span></span> as follows. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="match_defect_match_defectb"><span class="id" title="lemma">match_defect_match_defectb</span></a> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#match_defect"><span class="id" title="definition">match_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.normalise.html#match_defectb"><span class="id" title="definition">match_defectb</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">w</span></span> has a defect at <span class="inlinecode"><span class="id" title="var">n</span></span> means that <span class="inlinecode"><span class="id" title="var">w</span></span> can be decomposed as <span class="inlinecode"><span class="id" title="var">w1</span>++⟨<span class="id" title="var">a</span>!::<span class="id" title="var">w2</span></span>, with <span class="inlinecode"><span class="id" title="var">w1</span></span> having length <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">match_defectb</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="var">w2</span></span> holds. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="match_defect_at_n"><span class="id" title="definition">match_defect_at_n</span></a> <span class="id" title="var">w</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.normalise.html#match_defectb"><span class="id" title="definition">match_defectb</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>

<br/>
</div>

<div class="doc">
Notice that <span class="inlinecode"><span class="id" title="var">w</span></span> has a defect if and only if it has a defect at some <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="match_defect_at_n_spec"><span class="id" title="lemma">match_defect_at_n_spec</span></a> (<span class="id" title="var">w</span> : @<a class="idref" href="RIS.words.html#word"><span class="id" title="definition">word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="RIS.normalise.html#cf3d8280a8ff28a7f0bab74f475b6f3b"><span class="id" title="variable">𝐑</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#match_defect"><span class="id" title="definition">match_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="RIS.normalise.html#match_defect_at_n"><span class="id" title="definition">match_defect_at_n</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="match_defect_at_Sn"><span class="id" title="lemma">match_defect_at_Sn</span></a> <span class="id" title="var">l</span> <span class="id" title="var">w</span> <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#match_defect_at_n"><span class="id" title="definition">match_defect_at_n</span></a> (<a class="idref" href="RIS.normalise.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="RIS.normalise.html#match_defect_at_n"><span class="id" title="definition">match_defect_at_n</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">first_defect</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> holds when <span class="inlinecode"><span class="id" title="var">w</span></span> has a defect at <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">n</span></span> is the minimal such number. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="first_defect"><span class="id" title="definition">first_defect</span></a> <span class="id" title="var">w</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#match_defect_at_n"><span class="id" title="definition">match_defect_at_n</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <a class="idref" href="RIS.normalise.html#match_defect_at_n"><span class="id" title="definition">match_defect_at_n</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.normalise.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#9b077c369e19739ef880736ba34623ff"><span class="id" title="notation">≤</span></a> <a class="idref" href="RIS.normalise.html#k"><span class="id" title="variable">k</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="first_defect_Sn"><span class="id" title="lemma">first_defect_Sn</span></a> <span class="id" title="var">l</span> <span class="id" title="var">w</span> <span class="id" title="var">n</span> : <a class="idref" href="RIS.normalise.html#first_defect"><span class="id" title="definition">first_defect</span></a> (<a class="idref" href="RIS.normalise.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#first_defect"><span class="id" title="definition">first_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a>.<br/>

<br/>
</div>

<div class="doc">
We may also check that if <span class="inlinecode"><span class="id" title="var">w</span></span> has a defect then it has a first defect. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="match_defect_first_defect"><span class="id" title="lemma">match_defect_first_defect</span></a> (<span class="id" title="var">w</span> : @<a class="idref" href="RIS.words.html#word"><span class="id" title="definition">word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="RIS.normalise.html#cf3d8280a8ff28a7f0bab74f475b6f3b"><span class="id" title="variable">𝐑</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#match_defect"><span class="id" title="definition">match_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="RIS.normalise.html#first_defect"><span class="id" title="definition">first_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">defect_count</span></span> will be used later on to guess the number of rewrite steps needed to put a word in normal form. It counts the number of decompositions <span class="inlinecode"><span class="id" title="var">w1</span>++⟨<span class="id" title="var">a</span>!::<span class="id" title="var">w2</span></span> such that <span class="inlinecode"><span class="id" title="var">a</span>!</span> is not open-balanced in <span class="inlinecode"><span class="id" title="var">w2</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="defect_count"><span class="id" title="definition">defect_count</span></a> <span class="id" title="var">w</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒ 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<span class="id" title="var">a</span><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">w</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="RIS.words.html#d_binding"><span class="id" title="definition">d_binding</span></a> (<a class="idref" href="RIS.words.html#c766319c772ae26267ccf42e128dd861"><span class="id" title="definition">𝗙</span></a> (<span class="id" title="var">a</span><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="RIS.tools.html#f62e571aaf06e485801e62a5c9bd7232"><span class="id" title="notation">=?=</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">w</span> ⇒ <a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Notice that the following case distinction holds: 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="defect_count_disj"><span class="id" title="lemma">defect_count_disj</span></a> <span class="id" title="var">b</span> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#7a45dffb109c3069e5c675be68643e60"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="RIS.normalise.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#7a45dffb109c3069e5c675be68643e60"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#7a45dffb109c3069e5c675be68643e60"><span class="id" title="notation">∨</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#7a45dffb109c3069e5c675be68643e60"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <span class="id" title="var">a</span>, <a class="idref" href="RIS.normalise.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">)/\</span></a> <a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> (<a class="idref" href="RIS.normalise.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#7a45dffb109c3069e5c675be68643e60"><span class="id" title="notation">)</span></a>.<br/>

<br/>
</div>

<div class="doc">
In particular, having a positive <span class="inlinecode"><span class="id" title="var">defect_count</span></span> is equivalent to having a defect. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="defect_count_spec"><span class="id" title="lemma">defect_count_spec</span></a> <span class="id" title="var">w</span> : <a class="idref" href="RIS.normalise.html#match_defect"><span class="id" title="definition">match_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>.<br/>

<br/>
</div>

<div class="doc">
The following case distinction will be useful: either <span class="inlinecode"><span class="id" title="var">w</span></span> has no defect, otherwise it may be decomposed as <span class="inlinecode"><span class="id" title="var">w1</span>++<span class="id" title="var">open</span>(<span class="id" title="var">a</span>!)::<span class="id" title="var">w2</span>++<span class="id" title="var">close</span>(<span class="id" title="var">a</span>!)::<span class="id" title="var">w3</span></span> such that the first defect of <span class="inlinecode"><span class="id" title="var">w</span></span> is at <span class="inlinecode">⎢<span class="id" title="var">w1</span>⎥</span> and <span class="inlinecode"><span class="id" title="var">w2</span></span> does not contain a bracket labelled with <span class="inlinecode"><span class="id" title="var">a</span>!</span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="case_defect"><span class="id" title="lemma">case_defect</span></a> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#5bf2050e90b21ebc82dc5463d1ba338e"><span class="id" title="notation">{</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.normalise.html#match_defect"><span class="id" title="definition">match_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#5bf2050e90b21ebc82dc5463d1ba338e"><span class="id" title="notation">}</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#5bf2050e90b21ebc82dc5463d1ba338e"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#5bf2050e90b21ebc82dc5463d1ba338e"><span class="id" title="notation">{</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> <span class="id" title="var">w3</span> <span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a>(<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w3"><span class="id" title="variable">w3</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.normalise.html#first_defect"><span class="id" title="definition">first_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#5bf2050e90b21ebc82dc5463d1ba338e"><span class="id" title="notation">}</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab109"></a><h2 class="section">Dynamic sequences</h2>
 Dynamic sequences will be our normal forms. A <i>dynamic sequence</i> is a valid word that has no defect. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="dynamic_sequence"><span class="id" title="definition">dynamic_sequence</span></a> <span class="id" title="var">w</span> := <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.normalise.html#match_defect"><span class="id" title="definition">match_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>.<br/>

<br/>
</div>

<div class="doc">
This property is decidable. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="test_dyn_seq"><span class="id" title="definition">test_dyn_seq</span></a> (<span class="id" title="var">w</span> : @<a class="idref" href="RIS.words.html#word"><span class="id" title="definition">word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="RIS.normalise.html#cf3d8280a8ff28a7f0bab74f475b6f3b"><span class="id" title="variable">𝐑</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#test_valid"><span class="id" title="definition">test_valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#49ac24efa716d8b0ee8943bc1d1769a9"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.tools.html#f62e571aaf06e485801e62a5c9bd7232"><span class="id" title="notation">=?=</span></a> 0.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="test_dyn_seq_spec"><span class="id" title="lemma">test_dyn_seq_spec</span></a> <span class="id" title="var">w</span> : <a class="idref" href="RIS.normalise.html#test_dyn_seq"><span class="id" title="definition">test_dyn_seq</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="RIS.normalise.html#dynamic_sequence"><span class="id" title="definition">dynamic_sequence</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>.<br/>

<br/>
</div>

<div class="doc">
Dynamic sequences enjoy the following property: two dyn. seq. <span class="inlinecode"><span class="id" title="var">u</span>,<span class="id" title="var">v</span></span> are alpha-equivalent if and only if they are equal. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="equiv_dynamic_sequence_eq"><span class="id" title="lemma">equiv_dynamic_sequence_eq</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#dynamic_sequence"><span class="id" title="definition">dynamic_sequence</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#dynamic_sequence"><span class="id" title="definition">dynamic_sequence</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.tools.html#130feec68326dec2794bb89648a52e90"><span class="id" title="notation">≡</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab110"></a><h1 class="section">Normalisation</h1>
<a name="lab111"></a><h2 class="section">Rewrite steps</h2>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <a name="red_def"><span class="id" title="inductive">red_def</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Relations.Relation_Definitions.html#relation"><span class="id" title="definition">relation</span></a> <a class="idref" href="RIS.normalise.html#W"><span class="id" title="abbreviation">W</span></a> :=<br/>
&nbsp;&nbsp;| <a name="step"><span class="id" title="constructor">step</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">a</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#red_def"><span class="id" title="inductive">red_def</span></a> (<a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a><a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">)++</span></a><a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a>(<a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="red_def_valid"><span class="id" title="lemma">red_def_valid</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> : <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#red_def"><span class="id" title="inductive">red_def</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="red_def_defect_count"><span class="id" title="lemma">red_def_defect_count</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#red_def"><span class="id" title="inductive">red_def</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a>  <a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> 1.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="red_def_equiv"><span class="id" title="lemma">red_def_equiv</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#red_def"><span class="id" title="inductive">red_def</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a>  <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.tools.html#130feec68326dec2794bb89648a52e90"><span class="id" title="notation">≡</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">hide</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> goes through the word <span class="inlinecode"><span class="id" title="var">w</span></span>, applying to each letter the transposition <span class="inlinecode">(<span class="id" title="var">a</span>!,<span class="id" title="var">n</span>?)</span> until the letter <span class="inlinecode"><span class="id" title="var">a</span>!⟩</span> is found, after which the procedure stops. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="hide"><span class="id" title="definition">hide</span></a> <span class="id" title="var">a</span> <span class="id" title="var">n</span> <span class="id" title="var">w</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">w</span> ⇒ <span class="id" title="keyword">if</span> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a> (<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.tools.html#f62e571aaf06e485801e62a5c9bd7232"><span class="id" title="notation">=?=</span></a> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">)::</span></a><a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">)::(</span></a><a class="idref" href="RIS.normalise.html#hide"><span class="id" title="definition">hide</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
More directly, if <span class="inlinecode"><span class="id" title="var">w1</span>++<span class="id" title="var">a</span>!⟩::<span class="id" title="var">w2</span></span> is a decomposition of <span class="inlinecode"><span class="id" title="var">w</span></span> such that <span class="inlinecode"><span class="id" title="var">a</span>!⟩</span> does not appear in <span class="inlinecode"><span class="id" title="var">w1</span></span>, then <span class="inlinecode"><span class="id" title="var">hide</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> produces the word <span class="inlinecode">((<span class="id" title="var">a</span>!,<span class="id" title="var">n</span>?)∙<span class="id" title="var">w1</span>)++<span class="id" title="var">n</span>?⟩::<span class="id" title="var">w2</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="hide_close"><span class="id" title="lemma">hide_close</span></a> <span class="id" title="var">a</span> <span class="id" title="var">n</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a> <a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a>(<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>) <a class="idref" href="RIS.tools.html#97d4fc09a45292e6e0781158a2094d81"><span class="id" title="notation">∈</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#hide"><span class="id" title="definition">hide</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> (<a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a>(<a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a><a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">)++</span></a><a class="idref" href="RIS.words.html#close"><span class="id" title="constructor">close</span></a>(<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a>.<br/>

<br/>
</div>

<div class="doc">
This function is meant to remove the first defect of a word. The argument <span class="inlinecode"><span class="id" title="var">n</span></span> is used to store the length of list visited so far. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="remove_defect_aux"><span class="id" title="definition">remove_defect_aux</span></a> <span class="id" title="var">n</span> <span class="id" title="var">w</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a> (<span class="id" title="var">a</span><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">w</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="RIS.normalise.html#match_defectb"><span class="id" title="definition">match_defectb</span></a> <span class="id" title="var">a</span> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#hide"><span class="id" title="definition">hide</span></a> <span class="id" title="var">a</span> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="RIS.words.html#open"><span class="id" title="constructor">open</span></a>(<span class="id" title="var">a</span><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#remove_defect_aux"><span class="id" title="definition">remove_defect_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">w</span> ⇒ <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><a class="idref" href="RIS.normalise.html#remove_defect_aux"><span class="id" title="definition">remove_defect_aux</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="remove_defect"><span class="id" title="definition">remove_defect</span></a> := <a class="idref" href="RIS.normalise.html#remove_defect_aux"><span class="id" title="definition">remove_defect_aux</span></a> 0.<br/>

<br/>
</div>

<div class="doc">
If the word has no defect, then <span class="inlinecode"><span class="id" title="var">remove_defect</span></span> leaves it unchanged (whatever the numeric argument). If on the other hand <span class="inlinecode"><span class="id" title="var">w</span></span> has a first defect, then <span class="inlinecode"><span class="id" title="var">remove_defect</span></span> will perform a rewrite step. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="case_remove_defect"><span class="id" title="lemma">case_remove_defect</span></a> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#5bf2050e90b21ebc82dc5463d1ba338e"><span class="id" title="notation">{</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">¬</span></a><a class="idref" href="RIS.normalise.html#match_defect"><span class="id" title="definition">match_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.normalise.html#remove_defect"><span class="id" title="definition">remove_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#5bf2050e90b21ebc82dc5463d1ba338e"><span class="id" title="notation">}</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#5bf2050e90b21ebc82dc5463d1ba338e"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#5bf2050e90b21ebc82dc5463d1ba338e"><span class="id" title="notation">{</span></a><a class="idref" href="RIS.normalise.html#red_def"><span class="id" title="inductive">red_def</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> (<a class="idref" href="RIS.normalise.html#remove_defect"><span class="id" title="definition">remove_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#5bf2050e90b21ebc82dc5463d1ba338e"><span class="id" title="notation">}</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">remove_defect</span></span> preserves validity. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Proposition</span> <a name="remove_defect_valid"><span class="id" title="lemma">remove_defect_valid</span></a> <span class="id" title="var">w</span> : <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> (<a class="idref" href="RIS.normalise.html#remove_defect"><span class="id" title="definition">remove_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>).<br/>

<br/>
</div>

<div class="doc">
The number of defects of <span class="inlinecode"><span class="id" title="var">remove_defect</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> is exactly <span class="inlinecode"><span class="id" title="var">defect_count</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode">-</span> <span class="inlinecode">1</span>, meaning that if <span class="inlinecode"><span class="id" title="var">w</span></span> is not a dynamic sequence, <span class="inlinecode"><span class="id" title="var">remove_defect</span></span> will indeed remove one defect. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="defect_count_remove_defect"><span class="id" title="lemma">defect_count_remove_defect</span></a> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> (<a class="idref" href="RIS.normalise.html#remove_defect"><span class="id" title="definition">remove_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> 1.<br/>

<br/>
</div>

<div class="doc">
We may also show rather simply that <span class="inlinecode"><span class="id" title="var">remove_defect</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> is alpha-equivalent to <span class="inlinecode"><span class="id" title="var">w</span></span>, provided <span class="inlinecode"><span class="id" title="var">w</span></span> was valid. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="remove_defect_equiv"><span class="id" title="lemma">remove_defect_equiv</span></a> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#remove_defect"><span class="id" title="definition">remove_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.tools.html#130feec68326dec2794bb89648a52e90"><span class="id" title="notation">≡</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab112"></a><h2 class="section">Normalisation procedure</h2>
 <span class="inlinecode"><span class="id" title="var">iter</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> applies <span class="inlinecode"><span class="id" title="var">f</span></span> to <span class="inlinecode"><span class="id" title="var">x</span></span> successively <span class="inlinecode"><span class="id" title="var">n</span></span> times. <span class="inlinecode"><span class="id" title="var">iter</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> is in fact the Church numeral <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="iter"><span class="id" title="definition">iter</span></a> {<span class="id" title="var">A</span>} <span class="id" title="var">n</span> (<span class="id" title="var">f</span> : <a class="idref" href="RIS.normalise.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#A"><span class="id" title="variable">A</span></a>) <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span> ⇒ <a class="idref" href="RIS.normalise.html#iter"><span class="id" title="definition">iter</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.normalise.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="RIS.normalise.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="RIS.normalise.html#x"><span class="id" title="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
To normalise a word <span class="inlinecode"><span class="id" title="var">w</span></span>, we apply to it the <span class="inlinecode"><span class="id" title="var">remove_defect</span></span> function <span class="inlinecode"><span class="id" title="var">defect_count</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> times. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="normalise"><span class="id" title="definition">normalise</span></a> <span class="id" title="var">w</span> := <a class="idref" href="RIS.normalise.html#iter"><span class="id" title="definition">iter</span></a> (<a class="idref" href="RIS.normalise.html#defect_count"><span class="id" title="definition">defect_count</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="RIS.normalise.html#remove_defect"><span class="id" title="definition">remove_defect</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>.<br/>

<br/>
</div>

<div class="doc">
If we start with a valid word, <span class="inlinecode"><span class="id" title="var">normalise</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> will produce a dynamic sequence that is alpha-equivalent to <span class="inlinecode"><span class="id" title="var">w</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Proposition</span> <a name="normalise_spec"><span class="id" title="lemma">normalise_spec</span></a> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#dynamic_sequence"><span class="id" title="definition">dynamic_sequence</span></a> (<a class="idref" href="RIS.normalise.html#normalise"><span class="id" title="definition">normalise</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.tools.html#130feec68326dec2794bb89648a52e90"><span class="id" title="notation">≡</span></a> <a class="idref" href="RIS.normalise.html#normalise"><span class="id" title="definition">normalise</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a>.<br/>

<br/>
</div>

<div class="doc">
Combining what we have established so far, it immediately follows that two words over <span class="inlinecode"><span class="id" title="var">X</span></span> are alpha-equivalent if and only if their normal form after <span class="inlinecode">⟪<span class="id" title="var">_</span>⟫</span>-translation coincide. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="normal_form"><span class="id" title="lemma">normal_form</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>, <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.tools.html#130feec68326dec2794bb89648a52e90"><span class="id" title="notation">≡</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="RIS.normalise.html#normalise"><span class="id" title="definition">normalise</span></a> <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#normalise"><span class="id" title="definition">normalise</span></a> <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab113"></a><h1 class="section">Concatenation of valid words and dynamic sequences</h1>
 Validity and the property of being a dynamic sequence are not stable under concatenation. However, we may define alternative products on words that does preserve these properties while remaining alpha-equivalent to the concatenation. <a name="lab114"></a><h2 class="section">Addition as a permutation</h2>
 Obviously the operation <span class="inlinecode"><span class="id" title="var">n</span>+<span class="id" title="var">_</span></span> is not a finitely supported permutation, but if we know of a bound on the argument, we may build a permutation that mimics this operation.  <span class="inlinecode"><span class="id" title="var">shift</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> produces a permutation of pointers that bound numbers smaller that <span class="inlinecode"><span class="id" title="var">n</span></span> to their successors, <span class="inlinecode"><span class="id" title="var">n</span></span> to <span class="inlinecode">0</span> and maps free names and bound numbers greater than <span class="inlinecode"><span class="id" title="var">n</span></span> to themselves. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="shift"><span class="id" title="definition">shift</span></a> <span class="id" title="var">n</span> : (@<a class="idref" href="RIS.atoms.html#perm"><span class="id" title="definition">perm</span></a> (@<a class="idref" href="RIS.representative.html#pointer"><span class="id" title="inductive">pointer</span></a> <a class="idref" href="RIS.normalise.html#s.atom"><span class="id" title="variable">atom</span></a>) <span class="id" title="var">_</span>):=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">)++</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">)?</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="shift_free"><span class="id" title="lemma">shift_free</span></a> <span class="id" title="var">n</span> (<span class="id" title="var">a</span> : <a class="idref" href="RIS.normalise.html#s.atom"><span class="id" title="variable">atom</span></a>) : <a class="idref" href="RIS.normalise.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="shift_bound_n"><span class="id" title="lemma">shift_bound_n</span></a> <span class="id" title="var">n</span> : <a class="idref" href="RIS.normalise.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0<a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="shift_bound_gt"><span class="id" title="lemma">shift_bound_gt</span></a> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="shift_bound_lt"><span class="id" title="lemma">shift_bound_lt</span></a> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#shift"><span class="id" title="definition">shift</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">)?</span></a>.<br/>

<br/>
</div>

<div class="doc">
By iterating <span class="inlinecode"><span class="id" title="var">shift</span></span> cleverly, we can mimic addition by <span class="inlinecode"><span class="id" title="var">n</span></span> for numbers smaller that <span class="inlinecode"><span class="id" title="var">m</span></span>. This is the meaning of the permutation <span class="inlinecode"><span class="id" title="var">Shift</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="Shift"><span class="id" title="definition">Shift</span></a> <span class="id" title="var">n</span> <span class="id" title="var">m</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span> ⇒ <a class="idref" href="RIS.normalise.html#shift"><span class="id" title="definition">shift</span></a> (<a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a><a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="RIS.normalise.html#Shift"><span class="id" title="definition">Shift</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The specification of <span class="inlinecode"><span class="id" title="var">Shift</span></span> is described by the next two lemmas. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="Shift_free"><span class="id" title="lemma">Shift_free</span></a> (<span class="id" title="var">a</span> : <a class="idref" href="RIS.normalise.html#s.atom"><span class="id" title="variable">atom</span></a>) <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="RIS.normalise.html#Shift"><span class="id" title="definition">Shift</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#a"><span class="id" title="variable">a</span></a><a class="idref" href="RIS.representative.html#2e0d44e249a2f6dafd473fd5221f51ad"><span class="id" title="notation">!</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="Shift_bound_lt"><span class="id" title="lemma">Shift_bound_lt</span></a> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : <a class="idref" href="RIS.normalise.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#Shift"><span class="id" title="definition">Shift</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a><a class="idref" href="RIS.normalise.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">)?</span></a>.<br/>

<br/>
</div>

<div class="doc">
Notice that applying <span class="inlinecode"><span class="id" title="var">Shift</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> to any bound number yields some bound number. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Remark</span> <a name="Shift_bound"><span class="id" title="lemma">Shift_bound</span></a> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">∃</span></a> <span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="RIS.normalise.html#Shift"><span class="id" title="definition">Shift</span></a> <a class="idref" href="RIS.normalise.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="RIS.normalise.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a> <a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.normalise.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="RIS.normalise.html#8c7f2b6e89ab69e0e502c2cb6745e1f2"><span class="id" title="notation">?</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab115"></a><h2 class="section">Validity preserving concatenation</h2>
 If <span class="inlinecode"><span class="id" title="var">u</span></span> and <span class="inlinecode"><span class="id" title="var">v</span></span> are valid, then so is <span class="inlinecode"><span class="id" title="var">u</span>++<span class="id" title="var">Shift</span></span> <span class="inlinecode">⎢<span class="id" title="var">u</span>⎥⎢<span class="id" title="var">v</span>⎥∙<span class="id" title="var">v</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="valid_app"><span class="id" title="lemma">valid_app</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> : <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> (<a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.normalise.html#Shift"><span class="id" title="definition">Shift</span></a> <a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥⎢</span></a><a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a><a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a>).<br/>

<br/>
</div>

<div class="doc">
To concatenate dynamic sequences, we need in addition to normalise the result: 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="app_dyn"><span class="id" title="definition">app_dyn</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> := <a class="idref" href="RIS.normalise.html#normalise"><span class="id" title="definition">normalise</span></a> (<a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a><a class="idref" href="RIS.normalise.html#Shift"><span class="id" title="definition">Shift</span></a> <a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎢</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥⎢</span></a><a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="RIS.tools.html#f44388d00e0b32ec6f7109ab4f387b3b"><span class="id" title="notation">⎥</span></a><a class="idref" href="RIS.atoms.html#4957144be6046256f2cd37cd97a446fc"><span class="id" title="notation">∙</span></a><a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Infix</span> <a name="54c87f3eae4fb708f2a5698c804640bc"><span class="id" title="notation">&quot;</span></a> +++ " := <a class="idref" href="RIS.normalise.html#app_dyn"><span class="id" title="definition">app_dyn</span></a> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50).<br/>

<br/>
</div>

<div class="doc">
Indeed, whenever <span class="inlinecode"><span class="id" title="var">u</span></span> and <span class="inlinecode"><span class="id" title="var">v</span></span> are valid, <span class="inlinecode"><span class="id" title="var">u</span>+++<span class="id" title="var">v</span></span> is a dynamic sequence. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="app_dyn_dynamic_sequence"><span class="id" title="lemma">app_dyn_dynamic_sequence</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#dynamic_sequence"><span class="id" title="definition">dynamic_sequence</span></a> (<a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.normalise.html#54c87f3eae4fb708f2a5698c804640bc"><span class="id" title="notation">+++</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a>).<br/>

<br/>
</div>

<div class="doc">
Furthermore, <span class="inlinecode"><span class="id" title="var">u</span>+++<span class="id" title="var">v</span></span> is alpha-equivalent to <span class="inlinecode"><span class="id" title="var">u</span>++<span class="id" title="var">v</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="app_dyn_equiv_app"><span class="id" title="lemma">app_dyn_equiv_app</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> : <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.normalise.html#54c87f3eae4fb708f2a5698c804640bc"><span class="id" title="notation">+++</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="RIS.tools.html#130feec68326dec2794bb89648a52e90"><span class="id" title="notation">≡</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a>.<br/>

<br/>
</div>

<div class="doc">
This operation allows us to generalise our <span class="inlinecode"><span class="id" title="var">normal_form</span></span> theorem as follows: <span class="inlinecode"><span class="id" title="var">u</span></span> and <span class="inlinecode"><span class="id" title="var">v</span></span> are alpha-equivalent if and only if for any valid word <span class="inlinecode"><span class="id" title="var">w</span></span> we have <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode">+++</span> <span class="inlinecode">⟪<span class="id" title="var">u</span>⟫</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode">+++</span> <span class="inlinecode">⟪<span class="id" title="var">v</span>⟫</span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Proposition</span> <a name="app_dyn_equiv"><span class="id" title="lemma">app_dyn_equiv</span></a> <span class="id" title="var">u</span> <span class="id" title="var">v</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.tools.html#130feec68326dec2794bb89648a52e90"><span class="id" title="notation">≡</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <span class="id" title="keyword">∀</span> <span class="id" title="var">w</span>, <a class="idref" href="RIS.normalise.html#valid"><span class="id" title="definition">valid</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.normalise.html#54c87f3eae4fb708f2a5698c804640bc"><span class="id" title="notation">+++</span></a> <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="RIS.normalise.html#54c87f3eae4fb708f2a5698c804640bc"><span class="id" title="notation">+++</span></a> <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab116"></a><h1 class="section">Relational interpretation</h1>
 We now build a relational interpretation of words over <span class="inlinecode"><span class="id" title="var">X</span></span>, and prove that this interpretation is fully abstract with respect to alpha-equivalence, in the sense that two words will be alpha-equivalent if and only if they are mapped to the same binary relation by the interpretation.  We define the type of dynamic sequences using a sigma-type construction. This will form the base type for our relations. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Dyn"><span class="id" title="definition">Dyn</span></a> :=<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">{</span></a><span class="id" title="var">w</span> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">:</span></a> <a class="idref" href="RIS.words.html#word"><span class="id" title="definition">word</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">|</span></a> <a class="idref" href="RIS.normalise.html#test_dyn_seq"><span class="id" title="definition">test_dyn_seq</span></a> <a class="idref" href="RIS.normalise.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">}</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="Dyn_eq"><span class="id" title="lemma">Dyn_eq</span></a> (<span class="id" title="var">o1</span> <span class="id" title="var">o2</span> : <a class="idref" href="RIS.normalise.html#Dyn"><span class="id" title="definition">Dyn</span></a>) : <a class="idref" href="RIS.tools.html#8a6354b4c7c05b0e25c73aab15cce849"><span class="id" title="notation">$</span></a> <a class="idref" href="RIS.normalise.html#o1"><span class="id" title="variable">o1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.tools.html#8a6354b4c7c05b0e25c73aab15cce849"><span class="id" title="notation">$</span></a> <a class="idref" href="RIS.normalise.html#o2"><span class="id" title="variable">o2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="RIS.normalise.html#o1"><span class="id" title="variable">o1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#o2"><span class="id" title="variable">o2</span></a>.<br/>

<br/>
</div>

<div class="doc">
Recall that we consider two relations to be equal if they contain the same pairs. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a name="relseq"><span class="id" title="instance">relseq</span></a> : <a class="idref" href="RIS.tools.html#SemEquiv"><span class="id" title="class">SemEquiv</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Relations.Relation_Definitions.html#relation"><span class="id" title="definition">relation</span></a> <a class="idref" href="RIS.normalise.html#Dyn"><span class="id" title="definition">Dyn</span></a>) := <a class="idref" href="RIS.tools.html#eqRel"><span class="id" title="instance">eqRel</span></a>.<br/>

<br/>
</div>

<div class="doc">
The interpretation <span class="inlinecode">ρ</span> <span class="inlinecode"><span class="id" title="var">l</span></span> of a letter <span class="inlinecode"><span class="id" title="var">l</span></span> consists of the pairs <span class="inlinecode">(<span class="id" title="var">w</span>,<span class="id" title="var">w</span>+++⦑<span class="id" title="var">l</span>⦒)</span> for every dynamic sequence <span class="inlinecode"><span class="id" title="var">w</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="1af91fb19f8f622aa9ec8998986a6bf9"><span class="id" title="definition">ρ</span></a> : <a class="idref" href="RIS.words.html#letter"><span class="id" title="inductive">letter</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Relations.Relation_Definitions.html#relation"><span class="id" title="definition">relation</span></a> <a class="idref" href="RIS.normalise.html#Dyn"><span class="id" title="definition">Dyn</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> ⇒ <a class="idref" href="RIS.tools.html#8a6354b4c7c05b0e25c73aab15cce849"><span class="id" title="notation">$</span></a> <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.normalise.html#54c87f3eae4fb708f2a5698c804640bc"><span class="id" title="notation">(</span></a><a class="idref" href="RIS.tools.html#8a6354b4c7c05b0e25c73aab15cce849"><span class="id" title="notation">$</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a><a class="idref" href="RIS.normalise.html#54c87f3eae4fb708f2a5698c804640bc"><span class="id" title="notation">)</span></a> <a class="idref" href="RIS.normalise.html#54c87f3eae4fb708f2a5698c804640bc"><span class="id" title="notation">+++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦑</span></a><a class="idref" href="RIS.normalise.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="RIS.normalise.html#5ca7a42299f889aa6c99ba972ac06b94"><span class="id" title="notation">⦒</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
This interpretation lifts to words, in the sense that the relation associated with <span class="inlinecode"><span class="id" title="var">u</span></span> contains exactly the pairs <span class="inlinecode">(<span class="id" title="var">w</span>,<span class="id" title="var">w</span>+++⟪<span class="id" title="var">u</span>⟫)</span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="5d3708ad3a3538461b5c1057a30f2029"><span class="id" title="lemma">ρ</span></a><a name="5d3708ad3a3538461b5c1057a30f2029"><span class="id" title="lemma">_spec</span></a> <span class="id" title="var">u</span> : <a class="idref" href="RIS.tools.html#mapRel"><span class="id" title="definition">mapRel</span></a> <a class="idref" href="RIS.normalise.html#1af91fb19f8f622aa9ec8998986a6bf9"><span class="id" title="definition">ρ</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.tools.html#63510515077225ba3be50ed1e1ec3cec"><span class="id" title="notation">≃</span></a> <span class="id" title="keyword">fun</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> ⇒ <a class="idref" href="RIS.tools.html#8a6354b4c7c05b0e25c73aab15cce849"><span class="id" title="notation">$</span></a> <a class="idref" href="RIS.normalise.html#w2"><span class="id" title="variable">w2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="RIS.tools.html#8a6354b4c7c05b0e25c73aab15cce849"><span class="id" title="notation">$</span></a> <a class="idref" href="RIS.normalise.html#w1"><span class="id" title="variable">w1</span></a> <a class="idref" href="RIS.normalise.html#54c87f3eae4fb708f2a5698c804640bc"><span class="id" title="notation">+++</span></a> <a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟪</span></a><a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a><a class="idref" href="RIS.normalise.html#2d2bfc45b25e621d5e273890b7031081"><span class="id" title="notation">⟫</span></a>.<br/>

<br/>
</div>

<div class="doc">
It is then fairly routine to check that this relational interpretation is indeed fully-abstract. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="free_relational_interpretation"><span class="id" title="lemma">free_relational_interpretation</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>, <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.tools.html#130feec68326dec2794bb89648a52e90"><span class="id" title="notation">≡</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.8.0/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">↔</span></a> <a class="idref" href="RIS.tools.html#mapRel"><span class="id" title="definition">mapRel</span></a> <a class="idref" href="RIS.normalise.html#1af91fb19f8f622aa9ec8998986a6bf9"><span class="id" title="definition">ρ</span></a> <a class="idref" href="RIS.normalise.html#u"><span class="id" title="variable">u</span></a> <a class="idref" href="RIS.tools.html#63510515077225ba3be50ed1e1ec3cec"><span class="id" title="notation">≃</span></a> <a class="idref" href="RIS.tools.html#mapRel"><span class="id" title="definition">mapRel</span></a> <a class="idref" href="RIS.normalise.html#1af91fb19f8f622aa9ec8998986a6bf9"><span class="id" title="definition">ρ</span></a> <a class="idref" href="RIS.normalise.html#v"><span class="id" title="variable">v</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="RIS.normalise.html#s"><span class="id" title="section">s</span></a>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>